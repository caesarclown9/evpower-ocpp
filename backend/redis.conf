# Redis конфигурация для продакшена EvPower
# Базовые настройки
port 6379
bind 0.0.0.0
protected-mode yes
timeout 300
tcp-keepalive 60

# Персистентность данных
appendonly yes
appendfsync everysec
save 60 1000

# Память и производительность
maxmemory 256mb
maxmemory-policy allkeys-lru
maxmemory-samples 5

# Безопасность
# requirepass будет установлен через переменные окружения

# Логирование
loglevel notice
syslog-enabled no

# Сетевые настройки
tcp-backlog 511
databases 1

# Оптимизация для WebSocket соединений
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# Отключаем dangerous команды в продакшене
rename-command FLUSHDB ""
rename-command FLUSHALL ""
rename-command DEBUG ""
rename-command CONFIG "" 